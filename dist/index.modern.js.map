{"version":3,"file":"index.modern.js","sources":["../lib/index.tsx"],"sourcesContent":["import React, { useRef, useState } from 'react';\nimport classNames from 'classnames';\nimport styles from './index.module.css';\n\nexport interface Props {\n  value?: string;\n  dataSource: DataSourceItem[];\n  className?: string;\n  style?: React.CSSProperties;\n  placeholder?: string;\n  disabled?: boolean;\n  onBlur?: () => void;\n  onChange?: (text: string) => void;\n  onFocus?: () => void;\n  onConfirm?: (item: DataSourceItem) => void;\n}\n\nexport interface DataSourceItem {\n  value: string | number;\n  text: string;\n  [key: string]: any;\n}\n\nconst Autocomplete: React.ForwardRefRenderFunction<HTMLInputElement, Props> = (props, ref) => {\n  const { value, dataSource, className, onBlur, onChange, onFocus, onConfirm, ...others } = props;\n  const [matchedDSItem, setMatchedDSItem] = useState<DataSourceItem | null>();\n  const [_value, setValue] = useState('');\n  const controlledValue = value ?? _value;\n\n  // input ref\n  const inputRef = useRef<HTMLInputElement>();\n  React.useImperativeHandle(ref, () => inputRef.current!);\n\n  const wrapClassString = classNames('ria-wrap', styles.wrap, className);\n  const inputClassString = classNames('ria-input', styles.input);\n  const completeClassString = classNames('ria-complete', styles.complete);\n\n  const _onChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    // trigger onChange\n    const text = e.target.value;\n    onChange && onChange(text);\n    setValue(text);\n\n    // search matched data source item\n    if (!text) return setMatchedDSItem(null);\n    const matchedDSItem = dataSource.find((i) => i.text.startsWith(text));\n    setMatchedDSItem(matchedDSItem);\n  };\n\n  const _onConfirm = (e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.key !== 'Enter') return;\n    if (!matchedDSItem) return;\n\n    // trigger onChange\n    const text = matchedDSItem?.text;\n    setValue(text);\n    onChange && onChange(text);\n\n    // trigger onConfirm and reset\n    onConfirm && onConfirm(matchedDSItem);\n    setMatchedDSItem(null);\n  };\n\n  return (\n    <div className={wrapClassString}>\n      <input\n        ref={inputRef as any}\n        className={inputClassString}\n        value={controlledValue}\n        type=\"text\"\n        onBlur={onBlur}\n        onFocus={onFocus}\n        onChange={_onChange}\n        onKeyDown={_onConfirm}\n        {...others}\n      />\n      <div className={completeClassString}>{matchedDSItem?.text}</div>\n    </div>\n  );\n};\n\nconst RefAutoComplete = React.forwardRef<HTMLInputElement, Props>(Autocomplete);\nexport default RefAutoComplete;\n"],"names":["Autocomplete","props","ref","value","dataSource","className","onBlur","onChange","onFocus","onConfirm","others","matchedDSItem","setMatchedDSItem","useState","_value","setValue","controlledValue","inputRef","useRef","React","useImperativeHandle","current","wrapClassString","classNames","styles","wrap","inputClassString","input","completeClassString","complete","_onChange","e","text","target","find","i","startsWith","_onConfirm","key","type","onKeyDown","RefAutoComplete","forwardRef"],"mappings":";;;;;;;;;;;;;;;;;;;;AAuBA,MAAMA,YAAY,GAA4D,CAACC,KAAD,EAAQC,GAAR;AAC5E,QAAM;AAAEC,IAAAA,KAAF;AAASC,IAAAA,UAAT;AAAqBC,IAAAA,SAArB;AAAgCC,IAAAA,MAAhC;AAAwCC,IAAAA,QAAxC;AAAkDC,IAAAA,OAAlD;AAA2DC,IAAAA;AAA3D,MAAoFR,KAA1F;AAAA,QAA+ES,MAA/E,iCAA0FT,KAA1F;;AACA,QAAM,CAACU,aAAD,EAAgBC,gBAAhB,IAAoCC,QAAQ,EAAlD;AACA,QAAM,CAACC,MAAD,EAASC,QAAT,IAAqBF,QAAQ,CAAC,EAAD,CAAnC;AACA,QAAMG,eAAe,GAAGb,KAAH,WAAGA,KAAH,GAAYW,MAAjC;;AAGA,QAAMG,QAAQ,GAAGC,MAAM,EAAvB;AACAC,EAAAA,KAAK,CAACC,mBAAN,CAA0BlB,GAA1B,EAA+B,MAAMe,QAAQ,CAACI,OAA9C;AAEA,QAAMC,eAAe,GAAGC,UAAU,CAAC,UAAD,EAAaC,MAAM,CAACC,IAApB,EAA0BpB,SAA1B,CAAlC;AACA,QAAMqB,gBAAgB,GAAGH,UAAU,CAAC,WAAD,EAAcC,MAAM,CAACG,KAArB,CAAnC;AACA,QAAMC,mBAAmB,GAAGL,UAAU,CAAC,cAAD,EAAiBC,MAAM,CAACK,QAAxB,CAAtC;;AAEA,QAAMC,SAAS,GAAIC,CAAD;AAChB;AACA,UAAMC,IAAI,GAAGD,CAAC,CAACE,MAAF,CAAS9B,KAAtB;AACAI,IAAAA,QAAQ,IAAIA,QAAQ,CAACyB,IAAD,CAApB;AACAjB,IAAAA,QAAQ,CAACiB,IAAD,CAAR;;AAGA,QAAI,CAACA,IAAL,EAAW,OAAOpB,gBAAgB,CAAC,IAAD,CAAvB;AACX,UAAMD,aAAa,GAAGP,UAAU,CAAC8B,IAAX,CAAiBC,CAAD,IAAOA,CAAC,CAACH,IAAF,CAAOI,UAAP,CAAkBJ,IAAlB,CAAvB,CAAtB;AACApB,IAAAA,gBAAgB,CAACD,aAAD,CAAhB;AACD,GAVD;;AAYA,QAAM0B,UAAU,GAAIN,CAAD;AACjB,QAAIA,CAAC,CAACO,GAAF,KAAU,OAAd,EAAuB;AACvB,QAAI,CAAC3B,aAAL,EAAoB;;AAGpB,UAAMqB,IAAI,GAAGrB,aAAH,oBAAGA,aAAa,CAAEqB,IAA5B;AACAjB,IAAAA,QAAQ,CAACiB,IAAD,CAAR;AACAzB,IAAAA,QAAQ,IAAIA,QAAQ,CAACyB,IAAD,CAApB;;AAGAvB,IAAAA,SAAS,IAAIA,SAAS,CAACE,aAAD,CAAtB;AACAC,IAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACD,GAZD;;AAcA,SACEO,mBAAA,MAAA;AAAKd,IAAAA,SAAS,EAAEiB;GAAhB,EACEH,mBAAA,QAAA;AACEjB,IAAAA,GAAG,EAAEe;AACLZ,IAAAA,SAAS,EAAEqB;AACXvB,IAAAA,KAAK,EAAEa;AACPuB,IAAAA,IAAI,EAAC;AACLjC,IAAAA,MAAM,EAAEA;AACRE,IAAAA,OAAO,EAAEA;AACTD,IAAAA,QAAQ,EAAEuB;AACVU,IAAAA,SAAS,EAAEH;KACP3B,OATN,CADF,EAYES,mBAAA,MAAA;AAAKd,IAAAA,SAAS,EAAEuB;GAAhB,EAAsCjB,aAAtC,oBAAsCA,aAAa,CAAEqB,IAArD,CAZF,CADF;AAgBD,CAxDD;;AA0DA,MAAMS,eAAe,GAAGtB,KAAK,CAACuB,UAAN,CAA0C1C,YAA1C,CAAxB;;;;"}